!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=46)}([function(t,e,i){"use strict";var n=i(64),s=function(t){return t&&t.__esModule?t:{default:t}}(n),o=cc.winSize,a=cc.p(o.width/2,o.height/2),r=.5*o.width,c=o.width,u=o.height/1408,l=cc.p(0,0),h={hq:{hp:6e3,attack:80,defense:0,Size:100,Range:700,Sight:700,Cool:880,Speed:0,Cost:0,Klass:"entityHQ",animation:{idle:{name:"hq_idle",count:1,loop:!0},attack:{name:"hq_attack",count:1,loop:!1},die:{name:"hq_die",count:1,loop:!1}},armor:"heavy"},tower:{hp:4e3,attack:20,defense:0,Size:100,Range:700,Sight:700,Cool:220,Speed:0,Cost:0,Klass:"entityTower",animation:{idle:{name:"tower_idle",count:1,loop:!0},attack:{name:"tower_attack",count:1,loop:!1},die:{name:"tower_die",count:15,loop:!1}},armor:"heavy"}};t.exports={SCREEN_SIZE:o,BATTLE_HEIGHT:1408,TOP_BAR_WIDTH:c,TOP_BAR_HEIGHT:80,ACTION_FIELD_WIDTH:640,ACTION_FIELD_HEIGHT:320,ACTION_BAR_WIDTH:r,ACTION_BUTTON_SIZE:64,ACTION_BAR_HEIGHT:100,ACTION_BUTTON_WIDTH:120,ACTION_BUTTON_HEIGHT:160,ACTION_BUTTON_GAP:30,SCREEN_CENTER:a,BATTLE_SCALE:u,BATTLE_POSITION:l,ARENA_WIDTH:576,ARENA_HEIGHT:1024,ARENA_CELL_WIDTH:32,ARENA_CELL_HEIGHT:32,BIG_DISTANCE:1179648,MAX_CARDS_PER_ROUND:4,TURN_PADDING:4,POKEMONS:s.default,UNIT_DATA:h,ANIMATION_FPS:30,UNIT_STATE_IDLE:0,UNIT_STATE_WALK:1,UNIT_STATE_ATTACK:2,UNIT_STATE_DYING:3}},function(t,e,i){"use strict";var n=function(){this.translate=cc.p(0,0),this.rotate=0};n.prototype.setRotate=function(t){this.rotate=t},n.prototype.setTranslate=function(t){this.translate=t},t.exports=new n},function(t,e,i){"use strict";var n=i(5),s=function(t){return t&&t.__esModule?t:{default:t}}(n);t.exports={LEFT_TOP:0,LEFT_MIDDLE:1,LEFT_BOTTOM:2,CENTER_TOP:4,CENTER:5,CENTER_BOTTOM:6,RIGHT_TOP:8,RIGHT_MIDDLE:9,RIGHT_BOTTOM:10,RESIZE_STRETCH:0,RESIZE_COVER:1,RESIZE_CONTAIN:2,makeNode:function(t,e){var i=new cc.Node;return i.setPosition(e.position||cc.p(0,0)),i.setAnchorPoint(e.anchorPoint||cc.p(.5,.5)),i.setContentSize(e.contentSize||cc.size(0,0)),t.addChild(i,e.zOrder||0),i},makeImageView:function(t,e){var i=t.getContentSize(),n=cc.p(i.width/2,i.height/2),s=new ccui.ImageView(e.sprite,ccui.Widget.PLIST_TEXTURE),o=i;e.scale9Size?(s.ignoreContentAdaptWithSize(!1),s.setScale9Enabled(!0),s.setContentSize(e.scale9Size),o=e.scale9Size):e.contentSize?(s.setContentSize(e.contentSize),o=e.contentSize):e.scale&&s.setScale(e.scale),e.scaleX&&s.setScaleX(e.scaleX),e.scaleY&&s.setScaleY(e.scaleY),s.setAnchorPoint(e.anchorPoint||cc.p(.5,.5));var a=s.getContentSize();switch(e.resizeMode){case this.RESIZE_STRETCH:s.setScale(o.width/a.width,o.height/a.height);break;case this.RESIZE_COVER:s.setScale(Math.max(o.width/a.width,o.height/a.height));break;case this.RESIZE_CONTAIN:s.setScale(Math.min(o.width/a.width,o.height/a.height))}return s.setPosition(e.position||n),t.addChild(s,e.zOrder||0),s},makeSprite:function(t,e){var i=new cc.Sprite("#"+e.sprite);if(e.size){var n=i.getContentSize();i.setScale(e.size.width/n.width,e.size.height/n.height)}else i.setScale(e.scale||1);return i.setAnchorPoint(e.anchorPoint||cc.p(.5,.5)),i.setPosition(e.position||cc.p(0,0)),t.addChild(i,e.zOrder||0),i},makeText:function(t,e){var i=new ccui.Text(e.text,e.font,e.fontSize);return i.setScale(e.scale||1),i.setAnchorPoint(e.anchorPoint||cc.p(.5,.5)),i.setPosition(e.position||cc.p(0,0)),i.setTextHorizontalAlignment(e.horzAlign||cc.TEXT_ALIGNMENT_CENTER),i.setTextVerticalAlignment(e.vertAlign||cc.VERTICAL_TEXT_ALIGNMENT_CENTER),i.setTextColor(e.color||cc.color(255,255,255,255)),null!=e.ignoreContentAdaptWithSize&&i.ignoreContentAdaptWithSize(e.ignoreContentAdaptWithSize),e.size&&i.setSize(e.size),e.shadow&&i.enableShadow(e.shadowColor||cc.color(0,0,0,255),e.shadowOffset||cc.size(2,-2),0),e.outline&&i.enableOutline(e.outlineColor||cc.color(0,0,0,255),e.outlineSize||1),e.glow&&i.enableOutline(e.glowColor||cc.color(255,255,255,255)),t.addChild(i,e.zOrder||0),i},makeButton:function(t,e){var i=new ccui.Button;return i.loadTextures(e.normal||"",e.pressed||"",e.disabled||"",ccui.Widget.PLIST_TEXTURE),i.setScale(e.scale||1),i.setAnchorPoint(e.anchorPoint||cc.p(.5,.5)),i.setPosition(e.position||cc.p(0,0)),e.listener&&i.addTouchEventListener(e.listener,e.listenerTarget),t.addChild(i,e.zOrder||0),i},makeSlider:function(t,e){e=(0,s.default)({barTexture:"",buttonTexture:"",buttonTextureClicked:"",progressBarTexture:"",touchEnable:!0,anchorPoint:cc.p(.5,.5),position:cc.p(0,0),scale:1,onChange:function(){},onEvent:function(){}},e);var i=new ccui.Slider;return i.setTouchEnabled(!0),i.setScale(e.scale),i.setAnchorPoint(e.anchorPoint),i.setPosition(e.position),i.loadBarTexture(getResourceAlias(e.barTexture)),i.loadSlidBallTextures(getResourceAlias(e.buttonTexture),getResourceAlias(e.buttonTextureClicked),""),i.loadProgressBarTexture(getResourceAlias(e.progressBarTexture)),i.addEventListener(function(t,i){switch(i){case ccui.Slider.EVENT_PERCENT_CHANGED:e.onChange(t.getPercent().toFixed(0))}e.onEvent(t,i)}),t.addChild(i),i},makeMaskedSprite:function(t,e){var i=new cc.Sprite("#"+e.sprite);i.setScale(e.scale||1);var n=cc.Sprite.create("#"+e.mask);n.setScale(e.scale||1);var s=cc.ClippingNode.create(n);return s.setAlphaThreshold(.5),s.addChild(i,0),s.setAnchorPoint(e.anchorPoint||cc.p(.5,.5)),s.setPosition(e.position||cc.p(0,0)),t.addChild(s,e.zOrder||0),i},makeListView:function(t,e){var i=ccui.ListView.create();return i.setDirection(e.direction||ccui.ScrollView.DIR_VERTICAL),i.setAnchorPoint(e.anchorPoint||cc.p(.5,.5)),i.setPosition(e.position||cc.p(0,0)),i.setBounceEnabled(!0),i.setContentSize(e.contentSize||cc.size(0,0)),i.setClippingType(e.clippingType||ccui.Layout.CLIPPING_SCISSOR),i.setClippingEnabled(!0),t.addChild(i,e.zOrder||0),i},makeProgressBar:function(t,e){var i=ccui.LoadingBar.create();return i.loadTexture(e.sprite,ccui.Widget.PLIST_TEXTURE),e.scale&&i.setScale(e.scale),e.scaleX&&i.setScaleX(e.scaleX),e.scaleY&&i.setScaleY(e.scaleY),i.setPosition(e.position||cc.p(0,0)),i.setPercent(e.percent||0),t.addChild(i,e.zOrder||0),i},relativeTo:function(t,e,i,n){var s=e>>2&3,o=3&e,a=t.getContentSize();switch(s){case 1:i=a.width/2+i;break;case 2:i=a.width-i}switch(o){case 0:n=a.height-n;break;case 1:n=a.height/2+n}return cc.p(i,n)}}},function(t,e,i){"use strict";t.exports=function(t,e){var i,n,s;return t<0&&(t=-t),e<0&&(e=-e),t<e?(i=t,n=e):(i=e,n=t),s=1007*n+441*i,n<i<<4&&(s-=40*n),(s+512)/1024}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.getStoreState=e.disconnectStore=e.connectStore=e.storeDispatch=e.createStore=void 0;var s=i(29),o=n(s),a=i(16),r=n(a),c=i(5),u=n(c),l=i(70),h=n(l),f=i(14),d=n(f),p=i(15),g=n(p),_=i(65),T=n(_),v=i(67),A=n(v),S=i(66),m=n(S),E=[T.default,A.default,m.default],y=function(){function t(e){(0,d.default)(this,t),this.state={},this._reducers={},this._connectedScenes=[],this._reducers=e,this.clear()}return(0,g.default)(t,[{key:"getState",value:function(){return this.state}},{key:"clear",value:function(){var t=this;this.state=(0,h.default)(this._reducers).reduce(function(e,i){return(0,u.default)(e,(0,r.default)({},i,t._reducers[i]()))},{})}},{key:"restoreState",value:function(){var t=(0,v.loadState)((0,h.default)(this.state));for(var e in t)this.state[e]=(0,u.default)({},this.state[e],t[e])}},{key:"dispatch",value:function(t){var e=this;(0,o.default)(function(){"function"==typeof t?e.runDispatch(t(e.getState()),E.slice(0)):e.runDispatch(t,E.slice(0))})}},{key:"runDispatch",value:function(t,e){var i=this,n=this,s=this._reducers;0==e.length?(0,o.default)(function(){var e=i.state=(0,h.default)(s).reduce(function(e,n){return(0,u.default)(e,(0,r.default)({},n,s[n](i.state[n],t)))},{}),n=i._connectedScenes;t.callback&&t.callback(t,e),(0,o.default)(function(){n.forEach(function(t){return t.onStoreChange(e)})})}):e[0](this,t,function(t){e.splice(0,1),n.runDispatch(t,e)})}},{key:"discard",value:function(t){t.callback&&t.callback(t,this.state)}}]),t}(),I=void 0;e.createStore=function(t){return I=new y(t)},e.storeDispatch=function(t){return I&&I.dispatch(t)},e.connectStore=function(t){t&&t.onStoreChange&&I._connectedScenes.push(t)},e.disconnectStore=function(t){var e=I._connectedScenes.findIndex(function(e){return e==t});e>=0&&I._connectedScenes.splice(e,1)},e.getStoreState=function(){return I&&I.getState()}},function(t,e,i){t.exports={default:i(72),__esModule:!0}},function(t,e){var i=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=i)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=n(a),c=i(3),u=n(c),l={},h=cc.Node.extend({ctor:function(t,e){this._super(),this.logic={HP:0,x:0,y:0,z:0,cool:0},this.zShift=0,this.attr={},this.facing=0,this.team=t,this.presentation=e,this.state=o.default.UNIT_STATE_IDLE,this.stateData={target:null,time:0},this._departurePosition=cc.p(0,0),this._futurePosition=cc.p(0,0),this.sprite=new cc.Sprite,this.addChild(this.sprite),this.setFacing(0===this.team?1:-1)},isAlive:function(){return this.logic.HP>0},isWounded:function(){return this.logic.HP<this.attr.hp},isActive:function(){return this.logic.HP>0||this.stateData.time<2e3},damage:function(t){var e=Math.max(t-this.getDefense(),1);this.logic.HP-=e},heal:function(t){this.logic.HP+=t,this.logic.HP>this.attr.hp&&(this.logic.HP=this.attr.hp)},setUnitData:function(t){this.logic.HP=t.hp,this.attr=t,this.animAction={};var e=(t.name||"").toLowerCase(),i=t.animation||{idle:{name:e,count:1,loop:!0},attack:{name:e,count:1,loop:!1},die:{name:e,count:1,loop:!1},walk:{name:e,count:1,loop:!1}};for(var n in i)this.animAction[n]=this.createAnimAction(i[n],null==t.animation)},setFacing:function(t){this.facing=t;var e=r.default.rotate;t<0?0===e?this.setScaleX(1):(this.setScaleX(1),this.setScaleY(-1)):0===e?this.setScaleX(-1):(this.setScaleX(-1),this.setScaleY(-1))},setLocation:function(t,e){this.logic.x=t,this.logic.y=e,this.syncPosition()},convertPosition:function(t,e){return cc.p(t*o.default.ARENA_CELL_WIDTH/100,e*o.default.ARENA_CELL_HEIGHT/100)},convertZ:function(t){return t*o.default.ARENA_CELL_HEIGHT/100},update:function(t){},step:function(t){return this._departurePosition=this.convertPosition(this.logic.x,this.logic.y),this.logic.cool>0&&(this.logic.cool-=t,this.logic.cool<0&&(this.logic.cool=0)),!0},canAttack:function(t){return!0},canSee:function(t){return this.getDistanceTo(t)<this.getSight()},getDistanceToPos:function(t,e){var i=t-this.logic.x,n=e-this.logic.y;return(0,u.default)(i,n)},getDistanceTo:function(t){var e=t.logic.x-this.logic.x,i=t.logic.y-this.logic.y;return(0,u.default)(e,i)},animatePosition:function(){var t=this.presentation.timeFrameCounter/this.presentation.stepTime,e=cc.p(cc.lerp(this._departurePosition.x,this._futurePosition.x,t),cc.lerp(this._departurePosition.y,this._futurePosition.y,t));this.setLocalZOrder(0===r.default.rotate?o.default.ARENA_HEIGHT-e.y+this.zShift:e.y+this.zShift),e.y+=(0===r.default.rotate?1:-1)*this.convertZ(this.logic.z),this.setPosition(e)},syncPosition:function(){var t=this.convertPosition(this.logic.x,this.logic.y);this.setLocalZOrder(0===r.default.rotate?o.default.ARENA_HEIGHT-t.y+this.zShift:t.y+this.zShift),t.y+=(0===r.default.rotate?1:-1)*this.convertZ(this.logic.z),this.setPosition(t)},stepLiveliness:function(t){if(this.state===o.default.UNIT_STATE_DYING){if(this.stateData.time+=t,this.stateData.time>=2e3)return!1}else this.isAlive()||(this.state=o.default.UNIT_STATE_DYING,this.stateData.time=0,this._departurePosition=this._futurePosition,this.currentAction=this.intentAction=this.animAction.die,this.sprite.stopAllActions(),this.sprite.runAction(this.currentAction));return!0},createAnimAction:function(t,e){var i=t.name,n=t.count,s=l[i];if(!s){var a,r=[],c=0;for(c=0;c<n;++c)(a=e?cc.spriteFrameCache.getSpriteFrame(i+".png"):cc.spriteFrameCache.getSpriteFrame(i+"_"+c+".png"))&&r.push(a);s=new cc.Animation(r,1/o.default.ANIMATION_FPS),l[i]=s}return t.loop?new cc.RepeatForever(new cc.Animate(s)):new cc.Animate(s)},getSize:function(){return this.attr.Size||32},getAttack:function(){return this.attr.attack},getAttackFor:function(t){var e=t.armor||"none",i=this.getAttack();if("heavy"===e){return i+(this.attr.attackHeavy||0)}if("light"===e){return i+(this.attr.attackLight||0)}return i},getDefense:function(){return this.attr.defense},getRange:function(){return this.attr.Range||500},getSight:function(){return this.attr.Sight||1e3},getAttackCool:function(){return this.attr.Cool||1e3},getMoveSpeed:function(){return this.attr.Speed||300},isOfflane:function(){return 0===this.team?this.logic.y>o.default.BATTLE_HEIGHT*(2*o.default.ARENA_CELL_HEIGHT)/100:this.logic.y<o.default.BATTLE_HEIGHT*(2*o.default.ARENA_CELL_HEIGHT)/100}});t.exports=h},function(t,e,i){"use strict";function n(t){return c[t][currentLanguage]}function s(t){return c[t][currentLanguage].toUpperCase()}function o(t){var e=c[t][currentLanguage];return e.charAt(0).toUpperCase()+e.slice(1)}function a(t){return c[t][currentLanguage].toUpperCase()+":"}function r(t,e){return t=t||"",t.length<=e?t:t.substring(0,e)+"..."}var c={ok:{en:"ok",vn:"ok"},cancel:{en:"cancel",vn:"hủy"},yes:{en:"yes",vn:"có"},no:{en:"no",vn:"không"},instantPlay:{en:"instant play",vn:"chơi ngay"},option:{en:"option",vn:"tùy chọn"},help:{en:"help",vn:"hướng dẫn"},about:{en:"about",vn:"giới thiệu"},logout:{en:"logout",vn:"đăng xuất"},battle:{en:"battle",vn:"chiến"},train:{en:"train",vn:"luyện"},collect:{en:"collect",vn:"nhận thưởng"},level:{en:"level",vn:"cấp độ"},jackpot:{en:"jackpot",vn:"jackpot"},bet:{en:"bet",vn:"cược"},pleaseWait:{en:"please wait",vn:"vui lòng chờ"},noMoreBet:{en:"no more bet",vn:"không nhận cược"},blackjack_insurance:{en:"insurance?",vn:"insurance?"},pot:{en:"pot",vn:"pot"},total_bet:{en:"total bet",vn:"cược"},total_win:{en:"total win",vn:"thắng"},buy_in:{en:"buy in",vn:"tiền túi"},notEnoughMoney:{en:"not enough cash",vn:"không đủ tiền"},maxBetAlready:{en:"max bet already",vn:"không thể cược thêm"},inviteFriendMessage:{en:"play this game",vn:"play this game"},game_guide:{en:"game guide",vn:"hướng dẫn chơi"},option_setting:{en:"setting",vn:"tùy chỉnh"},option_notification:{en:"notification",vn:"thông báo"},music:{en:"music",vn:"nhạc"},sound:{en:"sound",vn:"âm thanh"},vibration:{en:"viration",vn:"rung"},general_notification:{en:"general",vn:"trung tâm"},friends:{en:"friends",vn:"bạn bè"},friends_notification:{en:"friends",vn:"bạn bè"},option_account:{en:"account",vn:"tài khoản"},spin:{en:"spin",vn:"quay"},ranking:{en:"ranking",vn:"xếp hạng"}};t.exports={get:n,getCaps:s,getCapFirst:o,shortenText:r,getCapsColon:a}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(7)),c=n(r),u=i(25),l=n(u),h=i(3),f=n(h),d=c.default.extend({setUnitData:function(t){this._super(t),this.currentAction=this.animAction.idle,this.sprite.runAction(this.currentAction)},update:function(t){this._super(t),this.animatePosition()},step:function(t){if(!this.stepLiveliness(t))return!1;if(this.state===o.default.UNIT_STATE_DYING)return!0;if(this._departurePosition=this.convertPosition(this.logic.x,this.logic.y),this.logic.cool>0&&(this.logic.cool-=t,this.logic.cool<0&&(this.logic.cool=0)),this.state===o.default.UNIT_STATE_IDLE&&(this.intentAction=this.animAction.idle,this.updateIdle()),this.state===o.default.UNIT_STATE_WALK){this.intentAction=this.animAction.walk,this.lookForEnemy();var e=this.stateData.target;if(e&&e.isAlive()){var i=e.logic.x-this.logic.x,n=e.logic.y-this.logic.y,s=(0,f.default)(i,n);if(s>this.getRange()){var a=t*this.getMoveSpeed()/1e3;this.setFacing(i>0?1:-1),this.logic.x+=i/s*a,this.logic.y+=n/s*a}else this.state=o.default.UNIT_STATE_ATTACK}else if(this.isOfflane())this.state=o.default.UNIT_STATE_IDLE;else{var a=t*this.getMoveSpeed()/1e3;0===this.team?this.logic.y+=a:this.logic.y-=a}}if(this.state===o.default.UNIT_STATE_ATTACK){var e=this.stateData.target;if(e&&e.isAlive()){if(this.logic.cool<=0){var r=this.getDistanceTo(e);r>this.getRange()?this.state=o.default.UNIT_STATE_WALK:(this.intentAction=this.animAction.attack,this.currentAction=null,this.logic.cool=this.getAttackCool(),this.createEffect(e))}}else this.state=o.default.UNIT_STATE_IDLE}return this._futurePosition=this.convertPosition(this.logic.x,this.logic.y),this.currentAction!==this.intentAction&&(this.currentAction=this.intentAction,this.sprite.stopAllActions(),this.sprite.runAction(this.currentAction)),!0},createEffect:function(t){var e=new l.default(this.team,this.presentation,this,t);this.presentation.addEffect(e)},lookForEnemy:function(){var t=this.presentation.findEnemy(this);t&&(this.stateData.target=t)},updateIdle:function(){var t=this.presentation.findEnemy(this);if(t)this.state=o.default.UNIT_STATE_WALK,this.stateData.target=t;else if(this.isOfflane()){var e=this.presentation.findGoal(this);e&&(this.state=o.default.UNIT_STATE_WALK,this.stateData.target=e)}else this.state=o.default.UNIT_STATE_WALK,this.stateData.target=null}});t.exports=d},function(t,e,i){t.exports={default:i(71),__esModule:!0}},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(5),o=n(s),a=i(4),r=i(22),c=n(r),u=i(63),l=n(u),h=cc.Scene.extend({ctor:function(t){t=t||{sprites:[],persitSprites:[],sounds:[]},this._super(),this.state={},this._waitingLayer=null,this._alertLayer=null,this._loadingCount=0,this._sprites=t.sprites||[],this._persitSprites=t.persitSprites||[],this._sounds=t.sounds||[]},onEnter:function(){this._super(),(0,a.connectStore)(this),this.loadResource(),this.loadSound()},checkReady:function(t){0==this._loadingCount&&this.onLoading&&this.onLoading(),this._loadingCount+=t?-1:1,0==this._loadingCount&&this.onReady&&this.onReady()},loadSound:function(){var t=this;this.checkReady(!1),this._sounds.length?Sound.preload(this._sounds,function(e){t.checkReady(!0)}):this.checkReady(!0)},loadResource:function(){var t=this;if(this.checkReady(!1),this._sprites.length||this._persitSprites.length){var e=[].concat(this._sprites,this._persitSprites);loadResources(e,function(){e.map(function(t){addSpriteFramesFromResource(t)}),t.checkReady(!0)})}else this.checkReady(!0)},unloadResource:function(){this._sprites.length&&this._sprites.map(function(t){removeSpriteFramesFromResource(t)})},onExit:function(){this._super(),(0,a.disconnectStore)(this),this.unloadResource()},onLoading:function(){this.showWaiting(!0)},onReady:function(){this.showWaiting(!1)},setState:function(t,e){var i=(0,o.default)({},this.state,t);this.onNextState&&this.onNextState(i),this.state=i,this.onStateChange&&this.onStateChange(this.state),e&&e()},showWaiting:function(t){t&&!this._waitingLayer&&(this._waitingLayer=new l.default(cc.winSize),this.addChild(this._waitingLayer,9e3)),this._waitingLayer&&this._waitingLayer.setVisible(t)},showError:function(t,e){this._alertLayer||(this._alertLayer=new c.default(cc.winSize),this.addChild(this._alertLayer,9900)),this._alertLayer.setError(t,e),this._alertLayer.setVisible(!0)}});t.exports=h},function(t,e,i){"use strict";t.exports={apiUrl:window.location.origin+"/api",socketUrl:"wss://"+window.location.host,localStorageName:"gamejam.rts"}},function(t,e,i){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,i){"use strict";e.__esModule=!0;var n=i(28),s=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s.default)(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}()},function(t,e,i){"use strict";e.__esModule=!0;var n=i(28),s=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=function(t,e,i){return e in t?(0,s.default)(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},function(t,e,i){t.exports=!i(19)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,i){var n=i(11),s=i(6),o=i(31),a=i(81),r=function(t,e,i){var c,u,l,h=t&r.F,f=t&r.G,d=t&r.S,p=t&r.P,g=t&r.B,_=t&r.W,T=f?s:s[e]||(s[e]={}),v=T.prototype,A=f?n:d?n[e]:(n[e]||{}).prototype;f&&(i=e);for(c in i)(u=!h&&A&&void 0!==A[c])&&c in T||(l=u?A[c]:i[c],T[c]=f&&"function"!=typeof A[c]?i[c]:g&&u?o(l,n):_&&A[c]==l?function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):p&&"function"==typeof l?o(Function.call,l):l,p&&((T.virtual||(T.virtual={}))[c]=l,t&r.R&&v&&!v[c]&&a(v,c,l)))};r.F=1,r.G=2,r.S=4,r.P=8,r.B=16,r.W=32,r.U=64,r.R=128,t.exports=r},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.authenticate=e.login=e.LOGIN=void 0;var s=i(16),o=n(s),a=i(5),r=n(a),c=e.LOGIN="LOGIN",u=(e.login=function(t,e){return{type:c,payload:t,callback:e,next:{persist:["authenticate"]}}},(0,o.default)({},c,function(t,e){return(0,r.default)(t,{id:e.payload.id})})),l={accessToken:null},h=e.authenticate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,e=arguments[1],i=e&&u[e.type];return i?i(t,e):t};e.default=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(7)),c=n(r),u=i(3),l=n(u),h=c.default.extend({ctor:function(t,e,i,n,s){this._super(t,e),this.target=null,this.life=300,this.owner=i,this.target=n,this.logic.x=this.owner.logic.x,this.logic.y=this.owner.logic.y,this.logic.z=this.owner.getSize()/2,this.startX=this.logic.x,this.startY=this.logic.y,this.startDistance=(0,l.default)(this.target.logic.x-this.startX,this.target.logic.y-this.startY),this.zShift=10,this.syncPosition(),this.idleAction=this.createAnimAction({name:s||"effect_bulleta_idle",count:1,loop:!0}),this.hitAction=this.createAnimAction({name:s||"effect_bulleta_idle",count:1,loop:!0}),this.state=o.default.UNIT_STATE_IDLE,this.sprite.runAction(this.idleAction)},update:function(t){this._super(t),this.animatePosition()},step:function(t){if(this._super(t),this.state===o.default.UNIT_STATE_IDLE){var e=!1,i=this.target.logic.x-this.logic.x,n=this.target.logic.y-this.logic.y,s=(0,l.default)(i,n);if(s>this.target.getSize()){var a=1.5*t;this.logic.x+=i/s*a,this.logic.y+=n/s*a;(0,l.default)(this.logic.x-this.startX,this.logic.y-this.startY)>=this.startDistance-this.target.getSize()&&(this.logic.x=this.target.logic.x,this.logic.y=this.target.logic.y,e=!0)}else e=!0;this._futurePosition=this.convertPosition(this.logic.x,this.logic.y),this.target.isAlive()||(e=!0),e&&(this.sprite.runAction(this.hitAction),this.state=o.default.UNIT_STATE_ATTACK,this.target.damage(this.owner.getAttackFor(this.target.attr))),this.sprite.setRotation(180*Math.atan2(i,n)/Math.PI)}else this.state===o.default.UNIT_STATE_ATTACK&&(this.life-=t);return this.life>0}});t.exports=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(10),o=n(s),a=i(8),r=n(a),c=i(2),u=n(c),l=ccui.Layout.extend({ctor:function(){this._super(),cc.spriteFrameCache.addSpriteFrames("mainmenu.plist"),this._error={},this._onClick=null;var t=cc.winSize;cc.p(t.width/2,t.height/2);this.setBackGroundColor(cc.color(8,8,8,128)),this.setBackGroundColorOpacity(128),this.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID),this.setSize(t),this.setTouchEnabled(!0),this.setSwallowTouches(!0);var e=u.default.makeImageView(this,{sprite:"popup_frame.png",scale9Size:cc.size(900,520),position:u.default.relativeTo(this,u.default.CENTER,0,0),ignoreContentAdaptWithSize:!1});this._text=u.default.makeText(e,{text:"",font:getNormalFontName(),fontSize:32,position:u.default.relativeTo(e,u.default.CENTER,0,40),size:cc.size(800,250),ignoreContentAdaptWithSize:!1});var i=u.default.makeButton(e,{normal:"button_blue.png",pressed:"button_blue_pressed.png",anchorPoint:cc.p(.5,0),position:u.default.relativeTo(e,u.default.CENTER_BOTTOM,0,30),listener:this.touchEvent,listenerTarget:this});return u.default.makeText(i,{text:r.default.getCaps("ok"),font:getBigFontName(),fontSize:32,position:u.default.relativeTo(i,u.default.CENTER,0,0)}),!0},setError:function(t,e){this._onClick=e,this._error=t,this._text.setString((0,o.default)(this._error))},touchEvent:function(t,e){e==ccui.Widget.TOUCH_ENDED&&(this.setVisible(!1),this._onClick&&this._onClick())}});e.default=l},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.room=e.startBattle=e.START_BATTLE=void 0;var s=i(16),o=n(s),a=i(5),r=n(a),c=e.START_BATTLE="START_BATTLE",u=(e.startBattle=function(t,e){return{type:c,api:{endpoint:"/battle/start",payload:t},callback:e}},(0,o.default)({},c,function(t,e){var i=e.response;return(0,r.default)(t,i)})),l={},h=e.room=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,e=arguments[1],i=e&&u[e.type];return i?i(t,e):t};e.default=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(7)),c=n(r),u=i(3),l=(n(u),c.default.extend({ctor:function(t,e,i,n){this._super(t,e),this.target=null,this.life=600,this.owner=i,this.target=n,this.logic.x=n.logic.x,this.logic.y=n.logic.y,this.logic.z=n.getSize(),this.zShift=10,this.syncPosition(),this.animAction=this.createAnimAction({name:"hit1_idle",count:1,loop:!1}),this.state=o.default.UNIT_STATE_IDLE},step:function(t){return this._super(t),this.life<=400&&this.state===o.default.UNIT_STATE_IDLE&&(this.sprite.runAction(this.animAction),this.state=o.default.UNIT_STATE_ATTACK,this.target.damage(this.owner.getAttack())),this.life-=t,this.life>0}}));t.exports=l},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(7)),c=n(r),u=i(25),l=(n(u),i(21)),h=n(l),f=c.default.extend({setUnitData:function(t){this._super(t),this.sprite.runAction(this.animAction.idle)},step:function(t){if(!this.stepLiveliness(t))return!1;if(this.state===o.default.UNIT_STATE_DYING)return!0;if(this._super(t),this.state===o.default.UNIT_STATE_IDLE){var e=this.presentation.findEnemy(this);e&&(this.stateData.target=e,this.sprite.runAction(this.animAction.attack),this.state=o.default.UNIT_STATE_ATTACK)}if(this.state===o.default.UNIT_STATE_ATTACK){var i=this.stateData.target;if(i&&i.isAlive()){if(this.logic.cool<=0){this.logic.cool=this.getAttackCool();var n=new h.default(this.team,this.presentation,this,i,"effect_bulletc_idle");this.presentation.addEffect(n)}}else this.sprite.runAction(this.animAction.idle),this.state=o.default.UNIT_STATE_IDLE}return!0}});t.exports=f},function(t,e,i){"use strict";var n=function(t){var e=t.onCreate,i=t.onShow,n=t.onHide,s=t.onDestroy;this.list=[],this.onCreate=e,this.onShow=i,this.onHide=n,this.onDestroy=s};n.prototype.clear=function(){for(var t=this.length-1;t>=0;--t)this.onDestroy.call(this.list[t]);this.list=[]},n.prototype.push=function(t){return this.onHide.call(t),this.list.push(t),t},n.prototype.pop=function(){var t;return this.list.length>0?(t=this.list[this.list.length-1],--this.list.length):t=this.onCreate(),this.onShow.call(t),t},t.exports=n},function(t,e,i){t.exports={default:i(73),__esModule:!0}},function(t,e,i){t.exports={default:i(75),__esModule:!0}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){var n=i(76);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,i){var n=i(23),s=i(11).document,o=n(s)&&n(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},function(t,e,i){var n=i(30);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,i){var n=i(77),s=i(83),o=i(96),a=Object.defineProperty;e.f=i(17)?Object.defineProperty:function(t,e,i){if(n(t),e=o(e,!0),n(i),s)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){var n=i(87),s=i(79);t.exports=Object.keys||function(t){return n(t,s)}},function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},function(t,e,i){var n=i(34),s=i(32);t.exports=function(t){return n(s(t))}},function(t,e,i){var n=i(32);t.exports=function(t){return Object(n(t))}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.appState=e.setAppState=e.UNLOAD_SOUND=e.UNLOAD_SPRITE=e.LOAD_SOUND=e.LOAD_SPRITE=e.SET_APP_STATE=void 0;var s=i(16),o=n(s),a=i(5),r=n(a),c=e.SET_APP_STATE="SET_APP_STATE",u=(e.LOAD_SPRITE="LOAD_SPRITE",e.LOAD_SOUND="LOAD_SOUND",e.UNLOAD_SPRITE="UNLOAD_SPRITE",e.UNLOAD_SOUND="UNLOAD_SOUND",e.setAppState=function(t,e){return{type:c,data:t,callback:e,next:{persist:["appState"]}}},(0,o.default)({},c,function(t,e){return(0,r.default)({},t,e.data)})),l={},h=e.appState=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,e=arguments[1],i=e&&u[e.type];return i?i(t,e):t};e.default=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(12),o=n(s),a=i(2),r=(n(a),i(13)),c=(n(r),i(8)),u=(n(c),i(4),i(27)),l=(n(u),i(58)),h=n(l),f=o.default.extend({ctor:function(){this._super({sprites:["battle.plist","buildings.plist","pokemons.plist","effects.plist"]})},onEnter:function(){this._super()},onLoading:function(){this._super(),cc.log("Loading battle...")},onReady:function(){this._super(),cc.log("Resource ready"),this.battle=new h.default,this.addChild(this.battle),this.battle.init(),this.battle.connect(),this.scheduleUpdate()},onExit:function(){this._super(),this.unscheduleUpdate(),this.battle.close()},update:function(t){this.battle.update(t)},onAction:function(t,e){this.battle.isReady()}});t.exports=f},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(12),o=n(s),a=i(2),r=(n(a),i(8)),c=(n(r),i(4)),u=i(24),l=cc.Layer.extend({ctor:function(){this._super()}}),h=o.default.extend({ctor:function(){this._super({sprites:["splash.plist"]})},onReady:function(){this._super(),this.addChild(new l);var t=(0,c.getStoreState)().authenticate;(0,c.storeDispatch)((0,u.startBattle)(t,function(t){t.error?(console.error(t.error),cc.director.runScene(new window.SplashScene)):cc.director.runScene(new window.InGameScene)}))}});t.exports=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(29),o=n(s),a=i(5),r=n(a),c=i(12),u=n(c),l=i(2),h=n(l),f=i(8),d=n(f),p=i(4),g=i(20),_=cc.Layer.extend({ctor:function(){this._super(),h.default.makeImageView(this,{sprite:"logo.png",position:h.default.relativeTo(this,h.default.TOP_CENTER,320,200)}),this.initUI()},initUI:function(){this.addButton("instantPlay",this.onInstantPlay,{position:h.default.relativeTo(this,h.default.CENTER,0,0)})},addButton:function(t,e,i){i=(0,r.default)({normal:"button_green.png",pressed:"button_green_pressed.png",anchorPoint:cc.p(.5,.5),position:h.default.relativeTo(this,h.default.LEFT_MIDDLE,30,30),listener:e,listenerTarget:this,scale:2},i||{});var n=h.default.makeButton(this,i);return h.default.makeText(n,{text:d.default.getCaps(t),font:getBigFontName(),fontSize:32,position:h.default.relativeTo(n,h.default.CENTER,0,0),shadow:!0}),n},onInstantPlay:function(t,e){e===ccui.Widget.TOUCH_ENDED&&(0,o.default)(function(){Sound.playSfx("click"),Sound.stopMusic();var t=(0,p.getStoreState)().authenticate,e=t.id||Math.random().toString(36).substr(2,9);(0,p.storeDispatch)((0,g.login)({id:e},function(){cc.director.runScene(new window.LoadingScene)}))})},onEnterOption:function(t,e){e===ccui.Widget.TOUCH_ENDED&&(Sound.playSfx("click"),(0,o.default)(function(){}))}}),T=u.default.extend({ctor:function(){this._super()},onEnter:function(){this._super(),this.addChild(new _)},onReady:function(){this._super(),Sound.playMusic("bg_music",!0)}});t.exports=T},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(12),o=n(s),a=i(2),r=(n(a),i(8)),c=(n(r),i(4),i(20),i(22)),u=(n(c),cc.Layer.extend({ctor:function(){this._super()}})),l=o.default.extend({ctor:function(){this._super({persitSprites:["splash.plist","ui.plist"],sounds:["bg_music","click"]})},onReady:function(){this._super(),this.addChild(new u),setTimeout(function(){cc.director.runScene(new window.MenuScene)},500)}});t.exports=l},function(t,e,i){"use strict";(function(e){function n(t){return t&&t.__esModule?t:{default:t}}var s=i(14),o=n(s),a=i(15),r=n(a),c=function(){function t(){(0,o.default)(this,t),this._sound_pool={},this._sfx={}}return(0,r.default)(t,[{key:"preload",value:function(t,e){var i=this.getSoundExtension(),n=[];t.map(function(t){n.push(t+i)}),loadResources(n,function(t){e&&e()})}},{key:"getSoundExtension",value:function(){var t=document.createElement("audio");return t.canPlayType&&t.canPlayType("audio/mpeg;").replace(/no/,"")?".mp3":!(!t.canPlayType||!t.canPlayType("audio/ogg;").replace(/no/,""))&&".ogg"}},{key:"getUrl",value:function(t){return getResourceAlias(t+this.getSoundExtension())}},{key:"setMusicVolume",value:function(t){cc.audioEngine.setMusicVolume(t)}},{key:"getMusicVolume",value:function(t){cc.audioEngine.setMusicVolume(t)}},{key:"setSfxVolume",value:function(t){cc.audioEngine.setEffectsVolume(t)}},{key:"getSfxVolume",value:function(t){cc.audioEngine.getEffectsVolume(t)}},{key:"playMusic",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];cc.audioEngine.playMusic(this.getUrl(t),e)}},{key:"stopMusic",value:function(){cc.audioEngine.stopMusic()}},{key:"playSfx",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._sfx[t]=cc.audioEngine.playEffect(this.getUrl(t),e)}},{key:"stopSfx",value:function(t){cc.audioEngine.stopEffect(this._sfx[t])}},{key:"stopAllSfx",value:function(t){cc.audioEngine.stopAllEffects()}},{key:"stopAll",value:function(){stopMusic(),stopAllEffects()}}]),t}();e.sound=e.sound||new c,t.exports=sound}).call(e,i(102))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(4),o=i(40),a=n(o),r=i(20),c=n(r),u=i(24),l=n(u);window||(window={}),window.MenuScene=i(43),window.SplashScene=i(44),window.InGameScene=i(41),window.LoadingScene=i(42),window.Sound=i(45),window.initApp=function(){console.log("init app..."),(0,s.createStore)({appState:a.default,authenticate:c.default,room:l.default}).restoreState()}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(2),o=n(s),a=i(27),r=(n(a),i(0)),c=n(r),u=i(49),l=n(u),h=cc.Node.extend({ctor:function(t){this._super(),this.frame=o.default.makeImageView(this,{sprite:"action_bar_panel.png",scale9Size:cc.size(c.default.ACTION_FIELD_WIDTH,c.default.ACTION_FIELD_HEIGHT),anchorPoint:cc.p(0,0),position:o.default.relativeTo(this,o.default.LEFT_BOTTOM,(c.default.SCREEN_SIZE.width-c.default.ACTION_FIELD_WIDTH)/2,c.default.ACTION_BUTTON_HEIGHT+48),ignoreContentAdaptWithSize:!1}),this.socket=t.socket,this.team=t.team,this.presentation=null,this._opts=t,this.cardButtons=[],this.hand=[],this.selectingCard=null,this.referenceCount=1,this.formationLayout=[],this.formation=null;var e=this;this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:e.onTouchBegan.bind(e),onTouchMoved:e.onTouchMoved.bind(e),onTouchEnded:e.onTouchEnded.bind(e),onTouchCancelled:e.onTouchCancelled(e)}),cc.eventManager.addListener(e._touchListener,e)},setHand:function(t){this.hand=t;for(var e=0;e<t.length;++e){var i=c.default.POKEMONS.find(function(i){return i.pokedex===t[e]});this.addCard(e,i)}this.selectingCard=this.cardButtons[0]},addCard:function(t,e){var i=new l.default({actionBar:this});i.setPosition(t*(c.default.ACTION_BUTTON_WIDTH+c.default.ACTION_BUTTON_GAP)+c.default.ACTION_BUTTON_GAP,c.default.ACTION_BUTTON_GAP),i.setPokemon(e,this.team),this.cardButtons.push(i),this.addChild(i,0)},select:function(t){this.selectingCard=t;for(var e=0;e<this.cardButtons.length;++e)this.cardButtons[e].unselect();t.select()},setFormation:function(t){var e=this;this.formation=t;for(var i=0;i<t.units.length;++i)!function(i){var n=t.units[i],s=e.formationLayout.find(function(t){return t.ref===n.ref});if(!s){var a=c.default.POKEMONS.find(function(t){return t.pokedex===n.name});s=o.default.makeSprite(e.frame,{sprite:a.name.toLowerCase()+".png"}),e.formationLayout.push(s)}s.setPosition(64*n.x+c.default.ACTION_FIELD_WIDTH/2+32,64*n.y+32)}(i)},onTouchEnded:function(t,e){},onTouchBegan:function(t,e){var i=this;if(this.containsTouchLocation(t)){var n=this.frame.getPosition(),s=t.getLocation(),o=s.x-n.x,a=s.y-n.y;o-=c.default.ACTION_FIELD_WIDTH/2,o=Math.floor(o/64),a=Math.floor(a/64);var r=c.default.POKEMONS.find(function(t){return t.pokedex===i.selectingCard.pokedex});if(!r)return;var u=r.total||100;if(this.presentation.gold<1e3*u)return;var l=!1,h=this.formation;if(h)for(var f=0;f<h.units.length;++f){var d=h.units[f];if(d.x===o&&d.y===a){l=!0;break}}l||(this.presentation.gold-=1e3*u,this.socket.send({x:o,y:a,type:"deploy",name:this.selectingCard.pokedex,ref:this.referenceCount++}))}},onTouchMoved:function(t,e){},onTouchCancelled:function(t,e){},containsTouchLocation:function(t){var e=t.getLocation(),i=this.frame.getContentSize(),n=cc.rect(0,0,i.width,i.height);return cc.rectContainsPoint(n,this.frame.convertToNodeSpace(e))}});t.exports=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(62),o=n(s),a=i(4),r=i(0),c=n(r),u=i(1),l=n(u),h=i(59),f=n(h),d=i(47),p=n(d),g=i(2),_=n(g),T=i(69),v=(n(T),i(22)),A=n(v),S=i(61),m=n(S),E=i(60),y=n(E),I=i(13),x={LOADING:0,WAITING:1,RUNNING:2,GAMEOVER:3},N=cc.Layer.extend({ctor:function(){this._super(),this.socket=new o.default,this.state=x.LOADING,this.currentTurn=0,this.receivedTurnCount=0,this.replay={},this.isLagged=!1},isReady:function(){return this.state===x.RUNNING},onOpenActionBar:function(t,e){e===ccui.Widget.TOUCH_ENDED&&this.actionBar.setVisible(!this.actionBar.isVisible())},init:function(){var t=(0,a.getStoreState)().room;this.ground=new cc.Sprite("#ground.png"),this.ground.setPosition(cc.p(c.default.SCREEN_CENTER.x+c.default.BATTLE_POSITION.x,c.default.SCREEN_CENTER.y+c.default.BATTLE_POSITION.y)),this.ground.setScale(c.default.BATTLE_SCALE),this.addChild(this.ground),this.openButton=_.default.makeButton(this,{normal:"blue_button.png",pressed:"blue_button.png",anchorPoint:cc.p(1,0),listener:this.onOpenActionBar,listenerTarget:this,scale:1.5,position:_.default.relativeTo(this,_.default.RIGHT_BOTTOM,5,5)}),_.default.makeImageView(this.openButton,{sprite:"badge_cyber.png",anchorPoint:cc.p(.5,.5),scale:.5,position:_.default.relativeTo(this.openButton,_.default.CENTER,0,0)}),this.actionBar=new p.default({socket:this.socket,team:t.playerId}),this.actionBar.setAnchorPoint(0,0),this.actionBar.setPosition(_.default.relativeTo(this,_.default.LEFT_BOTTOM,0,0)),this.addChild(this.actionBar,40);var e=new y.default({});e.setAnchorPoint(0,0),e.setPosition(_.default.relativeTo(this,_.default.LEFT_TOP,0,0)),this.addChild(e,60),this.topBar=e,this.actionBar.setVisible(!1);var i=this.ground.getContentSize();this.presentation=new f.default({team:t.playerId,actionBar:this.actionBar}),this.presentation.setPosition(i.width/2,i.height/2),this.ground.addChild(this.presentation,10),l.default.setRotate(0===t.playerId?0:180),this.presentation.rotate(l.default.rotate),this.lagNotify=new m.default,this.lagNotify.setText("Reconnecting..."),this.lagNotify.setVisible(!1),this.addChild(this.lagNotify),this.battleResult=new A.default,this.battleResult.setVisible(!1),this.addChild(this.battleResult,100)},connect:function(){var t=(0,a.getStoreState)().room,e=(0,a.getStoreState)().authenticate;this.socket.connect(I.socketUrl,{userId:e.id,roomId:t.roomId,accessToken:e.accessToken})},close:function(){this.socket.close()},send:function(t){this.socket.send(t)},update:function(t){if(this.state!==x.GAMEOVER){this.state===x.LOADING&&this.socket.isReady&&(this.send({type:"ready"}),this.state=x.WAITING);var e=this.socket.popMessage();if(e)switch(e.type){case"ready":this.handleReady(e);break;case"timeOver":this.handleTimeOver(e);break;case"turn":this.handleTurn(e);break;case"lagged":this.showLaggedWarning(),this.isLagged=!0}this.isLagged||this.presentation.update(t)}},showLaggedWarning:function(){this.lagNotify.setVisible(!0)},hideLaggedWarning:function(){this.lagNotify.setVisible(!1)},initGameOver:function(t){this.battleResult.setError(t.winnerId==(0,a.getStoreState)().room.playerId?"YOU WIN!":t.winnerId<0?"DRAW!":"YOU LOSE!",function(t){cc.director.runScene(new window.SplashScene)}),this.battleResult.setVisible(!0),this.state=x.GAMEOVER},handleReady:function(t){cc.log("Battle ready!"),this.state=x.RUNNING;var e=((0,a.getStoreState)().room,["001","002","003","004","005","006"]);this.actionBar.setHand(e),this.actionBar.setVisible(!1),this.presentation.init()},handleTimeOver:function(t){this.initGameOver({winnerId:-1})},handleTurn:function(t){if(this.state===x.RUNNING){this.replay[t.index]=t,t.index>this.receivedTurnCount&&(this.receivedTurnCount=t.index);var e=this.replay[this.currentTurn];if(e&&this.receivedTurnCount-this.currentTurn>=c.default.TURN_PADDING){this.hideLaggedWarning(),this.isLagged=!1;for(var i=e.deploy,n=0;n<i.length;++n){var s=i[n];this.presentation.deploy(s)}this.presentation.step(e.dt),this.topBar.setInfo(this.presentation.gold,this.presentation.time),++this.currentTurn,this.presentation.result?this.initGameOver(this.presentation.result):this.send({type:"ack",turn:this.currentTurn})}}}});t.exports=N},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(2),o=n(s),a=i(0),r=n(a),c=cc.Node.extend({ctor:function(t){this._super(),this.pokedex="",this.name="",this.team=0,this.index=0,this.actionBar=t.actionBar,this.frame=o.default.makeImageView(this,{sprite:"blue_button.png",scale9Size:cc.size(r.default.ACTION_BUTTON_WIDTH,r.default.ACTION_BUTTON_HEIGHT),anchorPoint:cc.p(0,0),position:o.default.relativeTo(this,o.default.CENTER,0,0),ignoreContentAdaptWithSize:!1}),this.costText=o.default.makeText(this.frame,{text:"0",font:getNormalFontName(),fontSize:32,anchorPoint:cc.p(.5,.5),position:o.default.relativeTo(this.frame,o.default.CENTER_BOTTOM,0,40),shadow:!0,zOrder:10});var e=new cc.Sprite;this.sprite=e,this.frame.addChild(e);var i=this;this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:i.onTouchBegan.bind(i),onTouchMoved:i.onTouchMoved.bind(i),onTouchEnded:i.onTouchEnded.bind(i),onTouchCancelled:i.onTouchCancelled(i)}),cc.eventManager.addListener(i._touchListener,i),this.isSelected=!1},setPokemon:function(t,e){var i=t.pokedex;this.pokedex===i&&this.team===e||(this.pokedex=t.pokedex,this.name=t.name,this.team=e,this.sprite.setSpriteFrame(this.name.toLowerCase()+".png"),this.sprite.setAnchorPoint(cc.p(.5,.5)),this.sprite.setPosition(o.default.relativeTo(this.frame,o.default.CENTER,0,20)),this.costText.setString(t.total))},unselect:function(){this.isSelected=!1,this.frame.loadTexture("blue_button.png",ccui.Widget.PLIST_TEXTURE)},select:function(){this.isSelected=!0,this.frame.loadTexture("yellow_button.png",ccui.Widget.PLIST_TEXTURE)},onTouchEnded:function(t,e){},onTouchBegan:function(t,e){this.containsTouchLocation(t)&&this.actionBar.select(this)},onTouchMoved:function(t,e){},onTouchCancelled:function(t,e){},containsTouchLocation:function(t){var e=t.getLocation(),i=this.frame.getContentSize(),n=cc.rect(0,0,i.width,i.height);return cc.rectContainsPoint(n,this.frame.convertToNodeSpace(e))}});t.exports=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(9)),c=n(r),u=i(21),l=n(u),h=i(3),f=n(h),d=c.default.extend({createEffect:function(t){var e=new l.default(this.team,this.presentation,this,t,this.attr.bulletName);this.presentation.addEffect(e)},step:function(t){if(!this.stepLiveliness(t))return!1;if(this.state===o.default.UNIT_STATE_DYING)return!0;if(this._departurePosition=this.convertPosition(this.logic.x,this.logic.y),this.logic.cool>0&&(this.logic.cool-=t,this.logic.cool<0&&(this.logic.cool=0)),this.state===o.default.UNIT_STATE_IDLE&&(this.intentAction=this.animAction.idle,this.updateIdle()),this.state===o.default.UNIT_STATE_WALK){this.intentAction=this.animAction.walk,this.lookForEnemy();var e=this.stateData.target;if(e&&e.isAlive()){var i=e.logic.x-this.logic.x,n=e.logic.y-this.logic.y,s=(0,f.default)(i,n);if(s>this.getRange()){var a=t*this.getMoveSpeed()/1e3;this.setFacing(i>0?1:-1),this.logic.x+=i/s*a,this.logic.y+=n/s*a}else this.state=o.default.UNIT_STATE_ATTACK}else if(this.isOfflane())this.state=o.default.UNIT_STATE_IDLE;else{var a=t*this.getMoveSpeed()/1e3;0===this.team?this.logic.y+=a:this.logic.y-=a}}if(this.state===o.default.UNIT_STATE_ATTACK){var e=this.stateData.target;if(e&&e.isAlive()){if(this.logic.cool<=0){var r=this.getDistanceTo(e);if(r>this.getRange())this.state=o.default.UNIT_STATE_WALK;else{this.intentAction=this.animAction.attack,this.currentAction=null,this.logic.cool=this.getAttackCool(),this.createEffect(e);var c=this.lookForSecondTarget();c&&c.isAlive()&&this.createEffect(c)}}}else this.state=o.default.UNIT_STATE_IDLE}return this._futurePosition=this.convertPosition(this.logic.x,this.logic.y),this.currentAction!==this.intentAction&&(this.currentAction=this.intentAction,this.sprite.stopAllActions(),this.sprite.runAction(this.currentAction)),!0},lookForSecondTarget:function(){var t=this.presentation.findEnemies(this,2);return t[0]!==this.target?t[0]:t[1]}});t.exports=d},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(7)),c=n(r),u=i(3),l=n(u),h=c.default.extend({ctor:function(t,e,i,n,s){this._super(t,e),this.target=null,this.life=300,this.owner=i,this.target=n,this.logic.x=this.owner.logic.x,this.logic.y=this.owner.logic.y,this.logic.z=this.owner.getSize()/2,this.startX=this.logic.x,this.startY=this.logic.y,this.startDistance=(0,l.default)(this.target.logic.x-this.startX,this.target.logic.y-this.startY),this.zShift=10,this.syncPosition(),this.idleAction=this.createAnimAction({name:"effect_heala_idle",count:1,loop:!0}),this.hitAction=this.createAnimAction({name:"effect_heala_hit",count:10,loop:!1}),this.state=o.default.UNIT_STATE_IDLE,this.sprite.runAction(this.idleAction)},update:function(t){this._super(t),this.animatePosition()},step:function(t){if(this._super(t),this.state===o.default.UNIT_STATE_IDLE){var e=!1,i=this.target.logic.x-this.logic.x,n=this.target.logic.y-this.logic.y,s=(0,l.default)(i,n);if(s>this.target.getSize()){var a=1.5*t;this.logic.x+=i/s*a,this.logic.y+=n/s*a;(0,l.default)(this.logic.x-this.startX,this.logic.y-this.startY)>=this.startDistance-this.target.getSize()&&(this.logic.x=this.target.logic.x,this.logic.y=this.target.logic.y,e=!0)}else e=!0;this._futurePosition=this.convertPosition(this.logic.x,this.logic.y),this.target.isAlive()||(e=!0),e&&(this.sprite.runAction(this.hitAction),this.state=o.default.UNIT_STATE_ATTACK,this.target.heal(this.owner.getAttackFor(this.target.attr))),this.sprite.setRotation(180*Math.atan2(i,n)/Math.PI)}else this.state===o.default.UNIT_STATE_ATTACK&&(this.life-=t);return this.life>0}});t.exports=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(7)),c=n(r),u=i(3),l=n(u),h=c.default.extend({ctor:function(t,e,i,n,s){this._super(t,e),this.target=null,this.life=1e3,this.owner=i,this.target=n,this.logic.x=this.owner.logic.x,this.logic.y=this.owner.logic.y,this.logic.z=this.owner.getSize()/2,this.startX=this.logic.x,this.startY=this.logic.y,this.startDistance=(0,l.default)(this.target.logic.x-this.startX,this.target.logic.y-this.startY),this.zShift=10,this.syncPosition(),this.idleAction=this.createAnimAction({name:s||"effect_bulleta_idle",count:1,loop:!0}),this.hitAction=this.createAnimAction({name:"effect_bulletf_hit",count:6,loop:!1}),this.state=o.default.UNIT_STATE_IDLE,this.sprite.runAction(this.idleAction)},update:function(t){this._super(t),this.animatePosition()},step:function(t){if(this._super(t),this.state===o.default.UNIT_STATE_IDLE){var e=!1,i=this.target.logic.x-this.logic.x,n=this.target.logic.y-this.logic.y,s=(0,l.default)(i,n);if(s>this.target.getSize()){var a=1.5*t;this.logic.x+=i/s*a,this.logic.y+=n/s*a;(0,l.default)(this.logic.x-this.startX,this.logic.y-this.startY)>=this.startDistance-this.target.getSize()&&(this.logic.x=this.target.logic.x,this.logic.y=this.target.logic.y,e=!0)}else e=!0;if(this._futurePosition=this.convertPosition(this.logic.x,this.logic.y),this.target.isAlive()||(e=!0),e){this.sprite.runAction(this.hitAction),this.state=o.default.UNIT_STATE_ATTACK;for(var r=this.presentation.findEnemyInArea(this.owner,this.logic.x,this.logic.y,this.owner.attr.SplashRange||200),c=0;c<r.length;++c)r[c].damage(this.owner.getAttackFor(r[c].attr))}this.sprite.setRotation(180*Math.atan2(i,n)/Math.PI)}else this.state===o.default.UNIT_STATE_ATTACK&&(this.life-=t);return this.life>0}});t.exports=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=(n(s),i(1)),a=(n(o),i(9)),r=n(a),c=i(21),u=n(c),l=i(3),h=(n(l),r.default.extend({createEffect:function(t){var e=new u.default(this.team,this.presentation,this,t,this.attr.bulletName);this.presentation.addEffect(e)}}));t.exports=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=(n(s),i(1)),a=(n(o),i(26)),r=n(a),c=r.default.extend({});t.exports=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(9)),c=n(r),u=i(51),l=n(u),h=i(3),f=n(h),d=c.default.extend({createEffect:function(t){var e=new l.default(this.team,this.presentation,this,t,this.attr.bulletName);this.presentation.addEffect(e)},step:function(t){if(!this.stepLiveliness(t))return!1;if(this.state===o.default.UNIT_STATE_DYING)return!0;if(this._departurePosition=this.convertPosition(this.logic.x,this.logic.y),this.logic.cool>0&&(this.logic.cool-=t,this.logic.cool<0&&(this.logic.cool=0)),this.state===o.default.UNIT_STATE_IDLE&&(this.intentAction=this.animAction.idle,this.updateIdle()),this.state===o.default.UNIT_STATE_WALK){this.intentAction=this.animAction.walk,this.lookForAlly();var e=this.stateData.target;if(e&&e.isAlive()){var i=e.logic.x-this.logic.x,n=e.logic.y-this.logic.y,s=(0,f.default)(i,n);if(s>this.getRange()){var a=t*this.getMoveSpeed()/1e3;this.setFacing(i>0?1:-1),this.logic.x+=i/s*a,this.logic.y+=n/s*a}else this.state=o.default.UNIT_STATE_ATTACK}else{var a=t*this.getMoveSpeed()/1e3;0===this.team?this.logic.y+=a:this.logic.y-=a}}if(this.state===o.default.UNIT_STATE_ATTACK){var e=this.stateData.target;if(e&&e.isAlive()){if(this.logic.cool<=0){var r=this.getDistanceTo(e);r>this.getRange()?this.state=o.default.UNIT_STATE_WALK:(this.intentAction=this.animAction.attack,this.currentAction=null,this.logic.cool=this.getAttackCool(),this.createEffect(e))}}else this.state=o.default.UNIT_STATE_IDLE}return this._futurePosition=this.convertPosition(this.logic.x,this.logic.y),this.currentAction!==this.intentAction&&(this.currentAction=this.intentAction,this.sprite.stopAllActions(),this.sprite.runAction(this.currentAction)),!0},updateIdle:function(){var t=this.presentation.findWoundedAlly(this);t?(this.state=o.default.UNIT_STATE_WALK,this.stateData.target=t):(this.state=o.default.UNIT_STATE_WALK,this.stateData.target=null)},lookForAlly:function(){var t=this.presentation.findWoundedAlly(this);t&&(this.stateData.target=t)}});t.exports=d},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=(n(s),i(1)),a=(n(o),i(9)),r=n(a),c=i(52),u=n(c),l=i(3),h=(n(l),r.default.extend({createEffect:function(t){var e=new u.default(this.team,this.presentation,this,t,this.attr.bulletName);this.presentation.addEffect(e)}}));t.exports=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(14),o=n(s),a=i(15),r=n(a),c=i(0),u=n(c),l=function(){function t(e){(0,o.default)(this,t),this.team=e,this.units=[]}return(0,r.default)(t,[{key:"add",value:function(t){this.units.push(t)}},{key:"getOffsetX",value:function(){return u.default.ARENA_WIDTH/2*100/u.default.ARENA_CELL_WIDTH}},{key:"getOffsetY",value:function(){var t=u.default.ARENA_HEIGHT/2*100/u.default.ARENA_CELL_HEIGHT;return 0===this.team?-t:100*u.default.ARENA_HEIGHT/u.default.ARENA_CELL_HEIGHT+t}}]),t}();t.exports=l},function(t,e,i){"use strict";var n=i(48),s=function(t){return t&&t.__esModule?t:{default:t}}(n);t.exports=s.default},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(0),o=n(s),a=i(1),r=(n(a),i(57)),c=n(r),u=i(26),l=n(u),h=i(54),f=n(h),d=i(9),p=(n(d),i(53)),g=n(p),_=i(55),T=n(_),v=i(56),A=n(v),S=i(50),m=n(S),E={entityHQ:f.default,entityTower:l.default},y=cc.Node.extend({ctor:function(t){this._super(),this.entities=[],this.team=t.team,this.actionBar=t.actionBar,this.actionBar.presentation=this,this.root=new cc.Node,this.root.setPosition(cc.p(-o.default.ARENA_WIDTH/2,-o.default.ARENA_HEIGHT/2)),this.addChild(this.root,0),this.gold=0,this.time=0,this.leftGoals=[],this.rightGoals=[],this.units=[],this.effects=[],this.timeFrameCounter=0,this.stepTime=1,this.result=null,this.formations=[]},rotate:function(t){this.setRotation(t)},init:function(){this.leftGoals.push(this.build({name:"tower",x:900,y:650,playerId:0})),this.leftGoals.push(this.build({name:"hq",x:900,y:50,playerId:0})),this.rightGoals.push(this.build({name:"tower",x:900,y:2550,playerId:1})),this.rightGoals.push(this.build({name:"hq",x:900,y:3150,playerId:1})),this.gold=2e5,this.time=1e4,this.formations=[]},update:function(t){this.timeFrameCounter+=1e3*t;for(var e=0;e<this.units.length;++e)this.units[e].update(t);for(var e=0;e<this.effects.length;++e)this.effects[e].update(t)},build:function(t){var e=o.default.UNIT_DATA[t.name];if(e){var i=E[e.Klass];if(i){return this.spawnUnit(i,t.playerId,t.x,t.y,e)}}},deploy:function(t){var e=t.playerId,i=this.formations[e];i||(i=new c.default(e),this.formations[e]=i);var n=o.default.POKEMONS.find(function(e){return e.pokedex===t.name});if(n){n.total;i.add(t),i.team===this.team&&this.actionBar.setFormation(i)}},spawnUnit:function(t,e,i,n,s){var o=new t(e,this);return o.setUnitData(s),o.setLocation(i,n),this.units.push(o),this.root.addChild(o),o},addEffect:function(t){this.effects.push(t),this.root.addChild(t)},step:function(t){this.timeFrameCounter=0,this.stepTime=t,this.gold+=10*t,this.time-=t,this.time<=0&&(this.time=1e4,this.deployAllFormations());for(var e=this.units.length-1;e>=0;--e){var i=this.units[e];i.step(t)||(this.units[e]=this.units[this.units.length-1],this.units.length--,i.removeFromParent())}for(var e=this.effects.length-1;e>=0;--e){var n=this.effects[e];n.step(t)||(this.effects[e]=this.effects[this.effects.length-1],this.effects.length--,n.removeFromParent())}var s=this.leftGoals[this.leftGoals.length-1],o=this.rightGoals[this.rightGoals.length-1];s.isActive()?o.isActive()||(s.isActive()?this.result={winnerId:0}:this.result={winnerId:-1}):o.isActive()?this.result={winnerId:1}:this.result={winnerId:-1}},findGoal:function(t){for(var e,i=t.team,n=0===i?this.rightGoals:this.leftGoals,s=o.default.BIG_DISTANCE,a=0;a<n.length;++a){var r=n[a];if(r.isAlive()){var c=r.getDistanceTo(t);c<s&&(e=r,s=c)}}return e},findEnemy:function(t){for(var e,i=o.default.BIG_DISTANCE,n=0;n<this.units.length;++n){var s=this.units[n];if(s.isAlive()&&s.team!==t.team&&t.canAttack(s)&&t.canSee(s)){var a=s.getDistanceTo(t);a<i&&(e=s,i=a)}}return e},findEnemies:function(t,e){for(var i=[],n=0;n<this.units.length;++n){var s=this.units[n];if(s.isAlive()&&s.team!==t.team&&t.canAttack(s)&&t.canSee(s)&&(i.push(s),--e<=0))break}return i},findEnemyInArea:function(t,e,i,n){for(var s=[],o=0;o<this.units.length;++o){var a=this.units[o];if(a.isAlive()&&a.team!==t.team&&t.canAttack(a)){a.getDistanceToPos(e,i)<n&&s.push(a)}}return s},findWoundedAlly:function(t){for(var e,i=o.default.BIG_DISTANCE,n=0;n<this.units.length;++n){var s=this.units[n];if(s.isAlive()&&s.isWounded()&&s.team===t.team&&t.canAttack(s)&&t.canSee(s)){var a=s.getDistanceTo(t);a<i&&(e=s,i=a)}}return e},deployAllFormations:function(){for(var t=0;t<this.formations.length;++t)this.deployFormation(this.formations[t])},deployFormation:function(t){if(t)for(var e=0;e<t.units.length;++e){var i=t.units[e],n=o.default.POKEMONS.find(function(t){return t.pokedex===i.name});if(!n)return;var s=null;switch(n.klass){case"gunner":s=g.default;break;case"healer":s=T.default;break;case"siege":s=A.default;break;case"dual":s=m.default}if(!s)return;var a=64*i.x*100/o.default.ARENA_CELL_WIDTH,r=64*i.y*100/o.default.ARENA_CELL_HEIGHT;1===t.team&&(r=-r),this.spawnUnit(s,t.team,a+t.getOffsetX(),r+t.getOffsetY(),n)}}});t.exports=y},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(2),o=n(s),a=i(0),r=n(a),c=cc.Node.extend({ctor:function(t){this._super();var e=o.default.makeImageView(this,{sprite:"action_bar_panel.png",scale9Size:cc.size(r.default.TOP_BAR_WIDTH,r.default.TOP_BAR_HEIGHT),anchorPoint:cc.p(0,1),position:o.default.relativeTo(this,o.default.LEFT_TOP,0,0),ignoreContentAdaptWithSize:!1});o.default.makeImageView(this,{sprite:"icon_coin.png",anchorPoint:cc.p(0,.5),position:o.default.relativeTo(this,o.default.LEFT_MIDDLE,20,-r.default.TOP_BAR_HEIGHT/2),contentSize:cc.size(40,40),resizeMode:o.default.RESIZE_STRETCH}),this.goldText=o.default.makeText(e,{text:"",font:getNormalFontName(),anchorPoint:cc.p(0,.5),fontSize:32,position:o.default.relativeTo(e,o.default.LEFT_MIDDLE,70,0),horzAlign:cc.TEXT_ALIGNMENT_LEFT}),o.default.makeImageView(this,{sprite:"icon_time.png",anchorPoint:cc.p(0,.5),position:o.default.relativeTo(this,o.default.LEFT_MIDDLE,240,-r.default.TOP_BAR_HEIGHT/2),contentSize:cc.size(40,40),resizeMode:o.default.RESIZE_STRETCH}),this.timeText=o.default.makeText(e,{text:"",font:getNormalFontName(),anchorPoint:cc.p(0,.5),fontSize:32,position:o.default.relativeTo(e,o.default.LEFT_MIDDLE,300,0),horzAlign:cc.TEXT_ALIGNMENT_LEFT})},setInfo:function(t,e){this.goldText.setString(Math.floor(t/1e3)),this.timeText.setString(Math.floor(e/1e3))}});t.exports=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(10),o=n(s),a=i(8),r=(n(a),i(2)),c=n(r),u=ccui.Layout.extend({ctor:function(){this._super(),cc.spriteFrameCache.addSpriteFrames("mainmenu.plist"),this._error={},this._onClick=null;var t=cc.winSize;cc.p(t.width/2,t.height/2);this.setBackGroundColor(cc.color(8,8,8,128)),this.setBackGroundColorOpacity(128),this.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID),this.setSize(t);var e=c.default.makeImageView(this,{sprite:"popup_frame.png",scale9Size:cc.size(900,520),position:c.default.relativeTo(this,c.default.CENTER,0,0),ignoreContentAdaptWithSize:!1});return this._text=c.default.makeText(e,{text:"",font:getNormalFontName(),fontSize:32,position:c.default.relativeTo(e,c.default.CENTER,0,40),size:cc.size(800,250),ignoreContentAdaptWithSize:!1}),!0},setText:function(t,e){this._onClick=e,this._error=t,this._text.setString((0,o.default)(this._error))}});e.default=u},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var s=i(10),o=n(s),a=i(14),r=n(a),c=i(15),u=n(c),l=function(){function t(){(0,r.default)(this,t),this._socket=null,this._messagesQueue=[],this._pendingQueue=[],this._pendingBuffer=[],this._query=null,this._address=null,this.isReady=!1,this._isActive=!0}return(0,u.default)(t,[{key:"close",value:function(){this.flush(),this.isReady=!1,this._isActive=!1,this._socket&&(this._socket.close(),this._socket=null)}},{key:"connect",value:function(t,e){this._address=t,this._query=e,this.tryConnect()}},{key:"buildQuery",value:function(t,e){var i=t,n=0;for(var s in e)i+=(0===n?"?":"&")+s+"="+e[s],++n;return i}},{key:"tryConnect",value:function(){this._socket=new WebSocket(this.buildQuery(this._address,this._query));var t=this;this._socket.onopen=function(e){cc.log("Socket client connected."),t.isReady=!0;for(var i=0;i<t._pendingQueue.length;++i)t.send(t._pendingQueue[i]);t._pendingQueue.length=0;for(var i=0;i<t._pendingBuffer.length;++i)t.sendBuffer(t._pendingBuffer[i]);t._pendingBuffer.length=0},this._socket.onmessage=function(e){e.data&&t._messagesQueue.push(e.data)},this._socket.onclose=function(e){cc.log("Socket was closed"),e.reason&&t._messagesQueue.push((0,o.default)({type:"close",reasons:e.reason})),t._socket=null,t.isReady=!1,t._isActive&&setTimeout(function(){cc.log("Retry socket connection"),t.tryConnect()},1e3)},this._socket.onerror=function(e){t._socket=null,t.isReady=!1}}},{key:"popMessage",value:function(){if(this._messagesQueue.length>0){var t,e=this._messagesQueue.shift();try{t=JSON.parse(e)}catch(t){cc.error(t)}return t}return null}},{key:"popRawMessage",value:function(){return this._messagesQueue.length>0?this._messagesQueue.shift():null}},{key:"send",value:function(t){if(this.isReady&&this._socket){var e=(0,o.default)(t);this._socket.send(e)}else this._pendingQueue.push(t)}},{key:"sendBuffer",value:function(t){this.isReady&&this._socket?this._socket.send(t):this._pendingBuffer.push(t)}},{key:"flush",value:function(){this._messagesQueue.length=0,this._pendingQueue.length=0,this._pendingBuffer.length=0}}]),t}();t.exports=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),s=function(t){return t&&t.__esModule?t:{default:t}}(n),o=ccui.Layout.extend({ctor:function(t){return this._super(),this._loadingProgress=0,this.setBackGroundColor(cc.color(8,8,8,128)),this.setBackGroundColorOpacity(128),this.setBackGroundColorType(ccui.Layout.BG_COLOR_SOLID),this.setSize(t),this.setTouchEnabled(!0),this.setSwallowTouches(!0),s.default.makeImageView(this,{sprite:"loading_bkg.png",zOrder:1}),this._loadingDot=s.default.makeImageView(this,{sprite:"loading_dot.png",zOrder:2}),this.setVisible(!1),!0},setVisible:function(t){this._super(t),t?this.scheduleUpdate():this.unscheduleUpdate()},update:function(t){this._loadingProgress+=360*t,this._loadingProgress>=360&&(this._loadingProgress-=360),this._loadingDot.setRotation(this._loadingProgress)}});e.default=o},function(t,e,i){"use strict";t.exports=[{pokedex:"001",name:"Bulbasaur",type:["GRASS","POISON"],total:50,hp:55,attack:6,attackHeavy:0,Cool:610,Range:500,Sight:700,defense:0,Speed:225,image:"bulbasaur.png",klass:"gunner",armor:"light",bulletName:"effect_bulleta_idle"},{pokedex:"002",name:"Ivysaur",type:["GRASS","POISON"],total:125,hp:125,attack:10,attackHeavy:10,Cool:1070,Range:600,Sight:800,defense:1,Speed:225,image:"ivysaur.png",klass:"gunner",armor:"heavy",bulletName:"effect_bulletb_idle"},{pokedex:"003",name:"Venusaur",type:["GRASS","POISON"],total:125,hp:60,attack:2,Cool:200,Range:600,Sight:1200,defense:1,Speed:225,image:"venusaur.png",klass:"healer",armor:"light"},{pokedex:"004",name:"Blastoise",type:["GRASS","POISON"],total:75,hp:75,attack:10,attackLight:15,Cool:1690,Range:600,Sight:800,defense:1,Speed:425,image:"blastoise.png",klass:"gunner",armor:"light",bulletName:"effect_bulletd_idle"},{pokedex:"005",name:"Charmander",type:["FIRE"],total:200,hp:175,attack:15,attackHeavy:10,Cool:740,Range:900,Sight:1e3,defense:1,Speed:315,image:"charmander.png",klass:"siege",armor:"heavy",bulletName:"effect_bullete_idle",SplashRange:300},{pokedex:"006",name:"Charmeleon",type:["FIRE"],total:375,hp:400,attack:30,Cool:1280,Range:700,Sight:800,defense:1,Speed:180,image:"charmeleon.png",klass:"dual",armor:"heavy",bulletName:"effect_bullete_idle"}]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.apiMiddleware=void 0;var s=i(10),o=n(s),a=i(68),r=n(a),c=i(13),u=e.apiMiddleware=function(t,e,i){if(!e.api||e.response||e.error)i(e);else{var n=t.getState().authenticate.accessToken,s={"Content-Type":"application/json","X-Access-Token":n};(0,r.default)({url:c.apiUrl+e.api.endpoint,method:e.api.method||"POST",header:s,data:(0,o.default)(e.api.payload),timeout:5e3},function(n,s,o){if(200==n)try{var a=JSON.parse(o),r=a.error;if(!r)return e.response=a,i(e);if(e.error=r,e.api.ignoreError)return i(e)}catch(t){e.error=[{code:"invalid_response",what:[o],say:t.toString()}]}else e.error=[{code:"http_error",what:[n]}];t.discard(e)})}};e.default=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=e.nextMiddleware=function(t,e,i){if(i(e),e.next){var n=e.next;delete e.next,t.dispatch(n)}};e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadState=e.storageMiddleware=void 0;var n=i(10),s=function(t){return t&&t.__esModule?t:{default:t}}(n),o=i(13),a=o.localStorageName,r=e.storageMiddleware=function(t,e,i){e.persist&&e.persist.forEach(function(e){var i=t.getState(),n=i[e];n&&cc.sys.localStorage.setItem((0,s.default)(a+e),(0,s.default)(n))}),i(e)};e.loadState=function(t){var e={};return t.forEach(function(t){try{var i=JSON.parse(cc.sys.localStorage.getItem((0,s.default)(a+t)));e[t]=i||{}}catch(t){}}),e};e.default=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=e.httpRequest=function(t,e){var i=t.url,n=t.method,s=t.header,o=t.data,a=t.timeout,r=cc.loader.getXMLHttpRequest();if(r.open(n||"GET",i,!0),r.timeout=a||5e3,s)for(var c in s)r.setRequestHeader(c,s[c]);r.onreadystatechange=function(){4==r.readyState&&(e&&e(r.status,r.response,r.responseText),e=null)},r.onerror=function(){e&&e(r.status,null,"loaded "+i+" error"),e=null},r.ontimeout=function(){e&&e(-1,null,"loaded "+i+" timeout"),e=null},o?r.send(o):r.send()};e.default=n},function(t,e,i){"use strict";t.exports=function(t){var e,i,n;for(n=t.length-1;n>0;n--)e=Math.floor(Math.random()*(n+1)),i=t[n],t[n]=t[e],t[e]=i}},function(t,e,i){t.exports={default:i(74),__esModule:!0}},function(t,e,i){var n=i(6),s=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},function(t,e,i){i(98),t.exports=i(6).Object.assign},function(t,e,i){i(99);var n=i(6).Object;t.exports=function(t,e,i){return n.defineProperty(t,e,i)}},function(t,e,i){i(100),t.exports=i(6).Object.keys},function(t,e,i){i(101),t.exports=i(6).setImmediate},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,i){var n=i(23);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,i){var n=i(38),s=i(95),o=i(94);t.exports=function(t){return function(e,i,a){var r,c=n(e),u=s(c.length),l=o(a,u);if(t&&i!=i){for(;u>l;)if((r=c[l++])!=r)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===i)return t||l||0;return!t&&-1}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e,i){var n=i(35),s=i(90);t.exports=i(17)?function(t,e,i){return n.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var n=i(11).document;t.exports=n&&n.documentElement},function(t,e,i){t.exports=!i(17)&&!i(19)(function(){return 7!=Object.defineProperty(i(33)("div"),"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},function(t,e,i){"use strict";var n=i(36),s=i(86),o=i(88),a=i(39),r=i(34),c=Object.assign;t.exports=!c||i(19)(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=c({},t)[i]||Object.keys(c({},e)).join("")!=n})?function(t,e){for(var i=a(t),c=arguments.length,u=1,l=s.f,h=o.f;c>u;)for(var f,d=r(arguments[u++]),p=l?n(d).concat(l(d)):n(d),g=p.length,_=0;g>_;)h.call(d,f=p[_++])&&(i[f]=d[f]);return i}:c},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,i){var n=i(80),s=i(38),o=i(78)(!1),a=i(91)("IE_PROTO");t.exports=function(t,e){var i,r=s(t),c=0,u=[];for(i in r)i!=a&&n(r,i)&&u.push(i);for(;e.length>c;)n(r,i=e[c++])&&(~o(u,i)||u.push(i));return u}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,i){var n=i(18),s=i(6),o=i(19);t.exports=function(t,e){var i=(s.Object||{})[t]||Object[t],a={};a[t]=e(i),n(n.S+n.F*o(function(){i(1)}),"Object",a)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,i){var n=i(92)("keys"),s=i(97);t.exports=function(t){return n[t]||(n[t]=s(t))}},function(t,e,i){var n=i(11),s=n["__core-js_shared__"]||(n["__core-js_shared__"]={});t.exports=function(t){return s[t]||(s[t]={})}},function(t,e,i){var n,s,o,a=i(31),r=i(84),c=i(82),u=i(33),l=i(11),h=l.process,f=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,g=l.Dispatch,_=0,T={},v=function(){var t=+this;if(T.hasOwnProperty(t)){var e=T[t];delete T[t],e()}},A=function(t){v.call(t.data)};f&&d||(f=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return T[++_]=function(){r("function"==typeof t?t:Function(t),e)},n(_),_},d=function(t){delete T[t]},"process"==i(30)(h)?n=function(t){h.nextTick(a(v,t,1))}:g&&g.now?n=function(t){g.now(a(v,t,1))}:p?(s=new p,o=s.port2,s.port1.onmessage=A,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(t){l.postMessage(t+"","*")},l.addEventListener("message",A,!1)):n="onreadystatechange"in u("script")?function(t){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),v.call(t)}}:function(t){setTimeout(a(v,t,1),0)}),t.exports={set:f,clear:d}},function(t,e,i){var n=i(37),s=Math.max,o=Math.min;t.exports=function(t,e){return t=n(t),t<0?s(t+e,0):o(t,e)}},function(t,e,i){var n=i(37),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},function(t,e,i){var n=i(23);t.exports=function(t,e){if(!n(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!n(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},function(t,e,i){var n=i(18);n(n.S+n.F,"Object",{assign:i(85)})},function(t,e,i){var n=i(18);n(n.S+n.F*!i(17),"Object",{defineProperty:i(35).f})},function(t,e,i){var n=i(39),s=i(36);i(89)("keys",function(){return function(t){return s(n(t))}})},function(t,e,i){var n=i(18),s=i(93);n(n.G+n.B,{setImmediate:s.set,clearImmediate:s.clear})},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i}]);
//# sourceMappingURL=bundle.js.map